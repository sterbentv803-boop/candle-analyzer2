<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Candle Analyzer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --border: #e2e8f0;
        }

        .dark {
            --primary: #3b82f6;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f1f5f9;
            --border: #334155;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, sans-serif; background: var(--bg); color: var(--text); transition: all 0.3s; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        .header { 
            text-align: center; margin-bottom: 30px; padding: 30px; 
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            color: white; border-radius: 20px;
        }
        
        .card { 
            background: var(--card); padding: 25px; margin-bottom: 25px; 
            border-radius: 15px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }
        
        .nav-tabs { display: flex; background: var(--card); border-radius: 12px; padding: 5px; margin-bottom: 25px; }
        .nav-tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; border-radius: 8px; }
        .nav-tab.active { background: var(--primary); color: white; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        
        .input-group { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .input-field { flex: 1; padding: 12px 16px; border: 2px solid var(--border); border-radius: 10px; background: var(--card); color: var(--text); }
        .select-field { padding: 12px 16px; border: 2px solid var(--border); border-radius: 10px; background: var(--card); color: var(--text); }
        
        .btn { 
            background: linear-gradient(135deg, var(--primary), #7c3aed); color: white; border: none; 
            padding: 12px 24px; border-radius: 10px; cursor: pointer; transition: all 0.3s; font-weight: 600;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4); }
        
        .chart-container { height: 400px; margin: 20px 0; }
        .theme-toggle { position: fixed; top: 20px; right: 20px; background: var(--card); border: 1px solid var(--border); 
                      border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        
        .signal-item { padding: 15px; margin: 10px 0; border-radius: 10px; border-left: 4px solid; }
        .signal-buy { border-left-color: var(--success); background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent); }
        .signal-sell { border-left-color: var(--danger); background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent); }
        
        .pattern-item { display: flex; justify-content: space-between; padding: 12px 15px; margin: 8px 0; background: var(--bg); border-radius: 8px; }
        .pattern-bullish { border-left: 4px solid var(--success); }
        .pattern-bearish { border-left: 4px solid var(--danger); }
        
        .loading { text-align: center; padding: 40px; }
        .spinner { border: 4px solid var(--border); border-top: 4px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        
        .error { background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent); color: var(--danger); padding: 20px; border-radius: 10px; border-left: 4px solid var(--danger); margin: 20px 0; }
        .success { background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent); color: var(--success); padding: 20px; border-radius: 10px; border-left: 4px solid var(--success); margin: 20px 0; }
        
        .symbol-tag { cursor: pointer; margin: 0 5px; padding: 4px 12px; background: var(--primary); color: white; border-radius: 15px; font-size: 0.8rem; display: inline-block; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
        
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .input-group { flex-direction: column; }
            .nav-tabs { flex-direction: column; }
            .chart-container { height: 300px; }
        }
    </style>
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()">
        <span id="themeIcon">üåô</span>
    </div>

    <div class="container">
        <div class="header">
            <h1>üìä Advanced Candle Analyzer</h1>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤</p>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('analysis')">–ê–Ω–∞–ª–∏–∑</div>
            <div class="nav-tab" onclick="switchTab('instructions')">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</div>
            <div class="nav-tab" onclick="switchTab('about')">–û –ø—Ä–æ–µ–∫—Ç–µ</div>
        </div>

        <!-- –ê–Ω–∞–ª–∏–∑ -->
        <div id="analysis" class="tab-content active">
            <div class="card">
                <h2>üîç –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞</h2>
                <div class="input-group">
                    <input type="text" id="symbolInput" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä (AAPL, TSLA...)" value="AAPL">
                    <select id="periodSelect" class="select-field">
                        <option value="1mo">1 –º–µ—Å—è—Ü</option>
                        <option value="3mo">3 –º–µ—Å—è—Ü–∞</option>
                        <option value="6mo" selected>6 –º–µ—Å—è—Ü–µ–≤</option>
                        <option value="1y">1 –≥–æ–¥</option>
                    </select>
                    <button class="btn" onclick="analyzeStock()" id="analyzeBtn">üìà –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <div id="popularSymbols" style="margin-top: 15px;"></div>
            </div>

            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ... –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥</p>
            </div>

            <div id="results" style="display: none;">
                <div class="card">
                    <h2>üìä –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω</h2>
                    <div class="chart-container">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <h2>üéØ –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã</h2>
                        <div id="signalsList"></div>
                    </div>

                    <div class="card">
                        <h2>üìà –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h2>
                        <div id="analysisInfo"></div>
                    </div>
                </div>

                <div class="card">
                    <h2>üéØ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã</h2>
                    <div id="patternsList"></div>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
        <div id="instructions" class="tab-content">
            <div class="card">
                <h2>üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</h2>
                <div style="line-height: 1.6;">
                    <h3>1. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h3>
                    <p>‚Ä¢ –í–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä –∞–∫—Ç–∏–≤–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞</p>
                    <p>‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞</p>
                    <p>‚Ä¢ –ù–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"</p>
                    <p>‚Ä¢ –ò–∑—É—á–∏—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Å–∏–≥–Ω–∞–ª—ã</p>
                    
                    <h3>2. –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–∫–µ—Ä–æ–≤</h3>
                    <p><strong>–ê–∫—Ü–∏–∏ –°–®–ê:</strong> AAPL, TSLA, MSFT, AMZN, GOOGL</p>
                    <p><strong>–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã:</strong> BTC-USD, ETH-USD, ADA-USD</p>
                    <p><strong>–ò–Ω–¥–µ–∫—Å—ã:</strong> ^GSPC (S&P 500), ^DJI (Dow Jones)</p>
                    
                    <h3>3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã</h3>
                    <p><strong>RSI (Relative Strength Index):</strong></p>
                    <p>‚Ä¢ –í—ã—à–µ 70 - –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å</p>
                    <p>‚Ä¢ –ù–∏–∂–µ 30 - –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å</p>
                    
                    <p><strong>MACD:</strong> –¢—Ä–µ–Ω–¥–æ–≤—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä</p>
                    <p><strong>–°–≤–µ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:</strong> –ú–æ–¥–µ–ª–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è</p>
                    
                    <h3>4. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤</h3>
                    <div class="signal-item signal-buy">
                        <strong>BUY —Å–∏–≥–Ω–∞–ª—ã</strong> - —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –ø–æ–∫—É–ø–∫—É
                    </div>
                    <div class="signal-item signal-sell">
                        <strong>SELL —Å–∏–≥–Ω–∞–ª—ã</strong> - —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –ø—Ä–æ–¥–∞–∂—É
                    </div>
                    
                    <div class="error" style="margin-top: 20px;">
                        <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –≠—Ç–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –ù–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π.
                    </div>
                </div>
            </div>
        </div>

        <!-- –û –ø—Ä–æ–µ–∫—Ç–µ -->
        <div id="about" class="tab-content">
            <div class="card">
                <h2>üöÄ –û –ø—Ä–æ–µ–∫—Ç–µ</h2>
                <p>Advanced Candle Analyzer - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤.</p>
                
                <h3>üåü –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h3>
                <ul style="margin-left: 20px; margin-bottom: 20px;">
                    <li>–ê–Ω–∞–ª–∏–∑ –∞–∫—Ü–∏–π, –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, –∏–Ω–¥–µ–∫—Å–æ–≤</li>
                    <li>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, Moving Averages)</li>
                    <li>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–≤–µ—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</li>
                    <li>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤</li>
                    <li>–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω</li>
                    <li>–¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º—ã</li>
                </ul>
                
                <h3>üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h3>
                <p><strong>Backend:</strong> Python Flask, yFinance, Pandas</p>
                <p><strong>Frontend:</strong> HTML5, CSS3, JavaScript, Chart.js</p>
                
                <div class="success">
                    <strong>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–ª—å:</strong> –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É.
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const API_BASE_URL = window.location.origin;

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let priceChart = null;
        let currentTheme = 'light';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadPopularSymbols();
            loadTheme();
            checkBackendHealth();
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // –¢–µ–º–Ω–∞—è —Ç–µ–º–∞
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.classList.toggle('dark', currentTheme === 'dark');
            document.getElementById('themeIcon').textContent = currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
            localStorage.setItem('theme', currentTheme);
            
            if (priceChart) priceChart.update('none');
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            currentTheme = savedTheme;
            document.body.classList.toggle('dark', currentTheme === 'dark');
            document.getElementById('themeIcon').textContent = currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ backend
        async function checkBackendHealth() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                const data = await response.json();
                console.log('Backend status:', data.status);
            } catch (error) {
                console.error('Backend not available:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
        async function loadPopularSymbols() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/symbols`);
                const data = await response.json();
                
                let html = '<strong>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã:</strong><br>';
                for (const [category, symbols] of Object.entries(data)) {
                    html += `<span style="font-size: 0.9rem;">${category}:</span> `;
                    html += symbols.map(symbol => 
                        `<span class="symbol-tag" onclick="setSymbol('${symbol}')">${symbol}</span>`
                    ).join(' ');
                    html += '<br>';
                }
                
                document.getElementById('popularSymbols').innerHTML = html;
            } catch (error) {
                console.error('Error loading symbols:', error);
            }
        }

        function setSymbol(symbol) {
            document.getElementById('symbolInput').value = symbol;
            analyzeStock();
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞
        async function analyzeStock() {
            const symbol = document.getElementById('symbolInput').value.trim().toUpperCase();
            const period = document.getElementById('periodSelect').value;
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');

            if (!symbol) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ç–∏–∫–µ—Ä');
                return;
            }

            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '‚è≥ –ê–Ω–∞–ª–∏–∑...';
            loading.style.display = 'block';
            results.style.display = 'none';

            try {
                const response = await fetch(`${API_BASE_URL}/api/analyze?symbol=${symbol}&period=${period}`);
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }

                displayResults(data);
                
            } catch (error) {
                showError(error.message);
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = 'üìà –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å';
                loading.style.display = 'none';
            }
        }

        function displayResults(data) {
            document.getElementById('results').style.display = 'block';
            
            updateMainChart(data);
            updateAnalysisInfo(data);
            updateSignalsList(data);
            updatePatternsList(data);
        }

        function updateMainChart(data) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            if (priceChart) {
                priceChart.destroy();
            }

            const labels = data.data.map(item => item.x);
            const prices = data.data.map(item => item.c);

            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `${data.symbol} - –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è`,
                        data: prices,
                        borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true },
                        tooltip: { mode: 'index', intersect: false }
                    }
                }
            });
        }

        function updateAnalysisInfo(data) {
            const analysisDiv = document.getElementById('analysisInfo');
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 15px; background: var(--bg); border-radius: 10px;">
                        <div style="font-size: 0.9rem; color: var(--text); opacity: 0.7;">–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">$${data.current_price.toFixed(2)}</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: var(--bg); border-radius: 10px;">
                        <div style="font-size: 0.9rem; color: var(--text); opacity: 0.7;">RSI</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: ${
                            data.rsi > 70 ? 'var(--danger)' : data.rsi < 30 ? 'var(--success)' : 'var(--warning)'
                        };">${data.rsi ? data.rsi.toFixed(2) : 'N/A'}</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: var(--bg); border-radius: 10px;">
                        <div style="font-size: 0.9rem; color: var(--text); opacity: 0.7;">–ü–∞—Ç—Ç–µ—Ä–Ω—ã</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">${data.patterns.length}</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: var(--bg); border-radius: 10px;">
                        <div style="font-size: 0.9rem; color: var(--text); opacity: 0.7;">–°–∏–≥–Ω–∞–ª—ã</div>
                        <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">${data.signals.length}</div>
                    </div>
                </div>
                <div class="success">
                    <strong>–ê–Ω–∞–ª–∏–∑:</strong> ${data.analysis}
                </div>
            `;
            
            analysisDiv.innerHTML = html;
        }

        function updateSignalsList(data) {
            const signalsDiv = document.getElementById('signalsList');
            
            if (data.signals.length === 0) {
                signalsDiv.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text); opacity: 0.7;">–¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã</div>';
                return;
            }

            let html = '';
            data.signals.forEach(signal => {
                const signalClass = signal.type === 'BUY' ? 'signal-buy' : 'signal-sell';
                
                html += `
                    <div class="signal-item ${signalClass}">
                        <div>
                            <strong>${signal.type} - ${signal.indicator}</strong>
                            <div style="margin-top: 5px; font-size: 0.9rem;">${signal.message}</div>
                        </div>
                        <div style="font-weight: bold; color: ${
                            signal.strength === 'HIGH' ? 'var(--danger)' : 
                            signal.strength === 'MEDIUM' ? 'var(--warning)' : 'var(--success)'
                        };">
                            ${signal.strength}
                        </div>
                    </div>
                `;
            });
            
            signalsDiv.innerHTML = html;
        }

        function updatePatternsList(data) {
            const patternsDiv = document.getElementById('patternsList');
            
            if (data.patterns.length === 0) {
                patternsDiv.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text); opacity: 0.7;">–°–≤–µ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã</div>';
                return;
            }

            let html = '';
            data.patterns.forEach(pattern => {
                const patternClass = `pattern-item pattern-${pattern.signal.toLowerCase()}`;
                html += `
                    <div class="${patternClass}">
                        <div>
                            <strong>${pattern.pattern}</strong>
                            <div style="font-size: 0.8rem; color: var(--text); opacity: 0.7;">${pattern.date}</div>
                        </div>
                        <div>
                            <span style="font-weight: bold; color: ${
                                pattern.signal === 'Bullish' ? 'var(--success)' : 
                                pattern.signal === 'Bearish' ? 'var(--danger)' : 'var(--warning)'
                            };">
                                ${pattern.signal}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            patternsDiv.innerHTML = html;
        }

        function showError(message) {
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.innerHTML = `
                <div class="error">
                    <strong>–û—à–∏–±–∫–∞:</strong> ${message}
                    <br><br>
                    <small>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:</small>
                    <ul>
                        <li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–∏–∫–µ—Ä–∞</li>
                        <li>–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–µ—Ä–∏–æ–¥</li>
                        <li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É</li>
                    </ul>
                </div>
            `;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter
        document.getElementById('symbolInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') analyzeStock();
        });
    </script>
</body>
</html>